DROP EXTERNAL TABLE if exists gphdfs.ext_active_directory_<CHANGE_MONTHDAY>; 
CREATE EXTERNAL TABLE gphdfs.ext_active_directory_<CHANGE_MONTHDAY> (
    id text,
    event_id text,
    device_id text,
    g_timestamp text,
    user_id text,
    prior_user_id text,
    g_ip text,
    s_ip text,
    t_ip text,
    transport_proto text,
    t_port text,
    s_port text,
    g_hostname text,
    s_hostname text,
    t_hostname text,
    malware_id text,
    s_bytes text,
    t_bytes text,
    http_status text,
    http_method text,
    http_hostname text,
    http_agent text,
    mime_type text,
    uri text,
    corr_count text,
    g_zone_id text,
    s_zone_id text,
    t_zone_id text,
    nsm_type text,
    message text,
    instdevice_id text,
    priority text,
    acquire_timestamp text,
    user_id_implementer text,
    user_id_requester text,
    user_id_approver text,
    "group_id" text,
    group_member_id text,
    object_name text,
    object_type text,
    process_executable text,
    object_access text,
    object_action text,
    in_interface text,
    out_interface text,
    mac text,
    g_mac text,
    s_mac text,
    t_mac text,
    ip text,
    acquire_ip text,
    tun_s_ip text,
    tun_t_ip text,
    n_s_ip text,
    n_t_ip text,
    hostname text,
    acquire_hostname text,
    icmp_code text,
    icmp_type text,
    n_s_port text,
    n_t_port text,
    s_email text,
    t_email text,
    http_referrer text,
    transaction_time text,
    acquire_zone_id text,
    zone_id text,
    device_backref text
)
LOCATION ('gphdfs://hdm1:8020/data/input/active_directory/<CHANGE_MONTHDAY>/*.gz')
FORMAT 'TEXT'(delimiter '	')
log errors into error.ext_active_directory_<CHANGE_MONTHDAY>_err segment reject limit 10000 rows;
